<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <title>Ht-markdown</title>
        <link rel="stylesheet" href="codemirror-4.7/lib/codemirror.css">
        <script src="js/jquery-1.10.2.min.js"></script>
        <script src="codemirror-4.7/lib/codemirror.js"></script>
        <!-- 言語に応じたjsファイルを読み込む -->
        <script src="codemirror-4.7/mode/javascript/javascript.js"></script>
        <script src="codemirror-4.7/addon/mode/overlay.js"></script>
        <script src="codemirror-4.7/mode/javascript/javascript.js"></script>
        <script src="codemirror-4.7/mode/markdown/markdown.js"></script>
        <script src="codemirror-4.7/mode/gfm/gfm.js"></script>

        <script src="codemirror-4.7/addon/edit/closebrackets.js"></script>

        <script src="marked/lib/marked.js"></script>
    </head>
    <body>
        <textarea id="editor_js" rows="30" cols="50"></textarea>
        <div id="result"></div>

        <script>
            
            marked.setOptions({
                        renderer: new marked.Renderer(),
                        gfm: true,
                        tables: true,
                        breaks: false,
                        pedantic: false,
                        sanitize: true,
                        smartLists: true,
                        smartypants: false
                    });

            $(function() {
                var jsEditor = CodeMirror.fromTextArea(document.getElementById('editor_js'), {
//                    mode: "javascript",
                    mode: "gfm",
                    lineNumbers: true,
                    indentUnit: 4,
                    autoCloseBrackets: true
                });
                
                jsEditor.on("change",function(){
                    jsEditor.save();
                    $("#result").html(marked(document.getElementById('editor_js').value));
                });

            });

        </script>
    </body>
</html>